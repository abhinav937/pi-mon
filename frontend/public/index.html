<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes, viewport-fit=cover" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="description" content="Pi Monitor - Raspberry Pi System Monitoring Dashboard" />
    <meta name="keywords" content="raspberry pi, monitoring, dashboard, system monitoring, pi monitor" />
    <meta name="author" content="Pi Monitor Team" />
    
    <!-- Mobile-specific meta tags -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Pi Monitor" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    
    <!-- PWA and app icons -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link rel="icon" type="image/x-icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="%PUBLIC_URL%/apple-touch-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/apple-touch-icon-180x180.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="%PUBLIC_URL%/apple-touch-icon-167x167.png" />
    
    <!-- Preconnect to improve performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Font loading optimization -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <title>Pi Monitor Dashboard</title>
    
    <!-- Mobile-specific CSS -->
    <style>
      /* Prevent flash of unstyled content */
      html {
        visibility: hidden;
        opacity: 0;
      }
      
      /* Mobile-specific optimizations */
      @media (max-width: 640px) {
        body {
          -webkit-text-size-adjust: 100%;
          -webkit-tap-highlight-color: transparent;
        }
        
        /* Improve touch targets */
        button, [role="button"] {
          min-height: 44px;
          min-width: 44px;
        }
        
        /* Prevent zoom on input focus */
        input, select, textarea {
          font-size: 16px;
        }
      }
      
      /* High-DPI display optimizations */
      @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
        img, svg {
          image-rendering: -webkit-optimize-contrast;
          image-rendering: crisp-edges;
        }
      }
      
      /* Landscape mobile optimizations */
      @media (max-width: 640px) and (orientation: landscape) {
        body {
          padding-top: env(safe-area-inset-top);
          padding-bottom: env(safe-area-inset-bottom);
        }
      }
      
      /* Portrait mobile optimizations */
      @media (max-width: 640px) and (orientation: portrait) {
        body {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <!-- Mobile-specific scripts -->
    <script>
      // Prevent flash of unstyled content
      document.addEventListener('DOMContentLoaded', function() {
        document.documentElement.style.visibility = 'visible';
        document.documentElement.style.opacity = '1';
      });
      
      // Mobile-specific optimizations
      // Register SW only outside localhost to avoid dev caching issues
      if ('serviceWorker' in navigator && !/^(localhost|127\.0\.0\.1)$/i.test(window.location.hostname)) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/sw.js')
            .then(function(registration) {
              console.log('SW registered: ', registration);
            })
            .catch(function(registrationError) {
              console.log('SW registration failed: ', registrationError);
            });
        });
      }
      
      // Prevent double-tap zoom on mobile
      let lastTouchEnd = 0;
      document.addEventListener('touchend', function (event) {
        const now = (new Date()).getTime();
        if (now - lastTouchEnd <= 300) {
          event.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      // Handle mobile orientation changes
      window.addEventListener('orientationchange', function() {
        setTimeout(function() {
          window.scrollTo(0, 0);
        }, 100);
      });
      
      // Mobile performance optimizations
      if ('requestIdleCallback' in window) {
        requestIdleCallback(function() {
          // Preload critical resources
          const criticalImages = document.querySelectorAll('img[data-critical]');
          criticalImages.forEach(img => {
            if (img.dataset.src) {
              img.src = img.dataset.src;
            }
          });
        });
      }
    </script>
  </body>
</html>